## 异常与错误处理

**Java 的异常处理机制使Java语言开发的软件系统具有高度的可靠性、稳定性和容错性。**

- 从语法角度看， 异常处理语句将程序正常代码与错误处理代码分开，使程序结构清晰，重点突出，可读性强。

- 从运行效果看，异常处理语句使程序具有处理错误的能力。即使程序运行期间发生了错误，应用程序也可以及时捕获异常并及时处理，而不导致程序运行非正常终止。

### 错误和异常

Java 将运行错误分为两类：错误(Error)和异常(Exception)，都会打断程序的运行，都是Throwable类的子类，层次结构如下图。

![层次结构](https://github.com/admirzfc/CodeInterviews/blob/master/notebook/Java/IMG_1596.JPG)

2. `错误:` 错误值运行时遇到的硬件错误、或操作系统错误、操作错误等 ，错误对于程序而言是致命的，将导致程序无法运行，程序本身是无法处理错误的，需要外界的干预，否则一直处于非正常的状态。
   
   java.lang,Error 是错误类，当产生错误时，java 虚拟机生成并抛出Error类对象。常见的错误类包括 NoClassDefFoundError类(运行没有main()方法的类)、OutOfMemoryError(内存溢出错误)。

3. `异常`，Exception是指在外界环境正常时，程序产生的运行错误。例如，除数为0，操作数超出数据范围，输入数据格式错误，文件不存在，网络连接中断、数据库连接中断等。Java定义的异常类主要分为运行异常和非运行异常。**运行异常**是指用程序本身错误或数据错误引发的异常，这类异常程序设计时大多可以避免；**非运行期异常**指由程序运行环境错误引发的异常，这类异常必须要捕获处理。一个异常对象经历抛出、捕获和处理过程。创建一个异常类对象的过程称为抛出，获得异常对象的过程称为捕获异常，对异常对象执行相应的操作的过程称为处理异常，异常对象由捕获他的语句进行处理。
   
   ```
   try{
       <存在潜在异常的语句>；
   } catch(异常类 异常对象) {
       <捕获异常对象并进行处理的语句>；
   } finally {
       <最后必须执行的语句，无论是否产生异常是否捕获异常，都要执行>；
   }
   ```
   
   如果所有的catch语句都没有捕获exception，则exception将由Java虚拟机捕获并处理，导致程序运行停止。

4. `异常抛出:`如果程序中存在逻辑错误但不是Java的异常，程序也可以采用Throw语句主动抛出一个异常对象。
   
   如果一个方法产生异常，而该方法不想处理或不能处理该异常，则可以在方法声明时，采用throws子句声明改方法抛出异常。如:
   
   ```
   public void set(int year,int month,int day) throws Exception;
   ```
   
   开发者可以根据自己的需要自定义异常类，但必须是Exception的子类。

5. throw和throws的使用
   
   throws出现在声明方法的位置，而throw出现在函数体中；
   
   如果在某个函数内部用throw抛出了异常，那么在声明该函数时，一定要配套使用throws，否则会出现语法错误；
   
   如果在某个函数的声明位置出现了用throws抛出异常的情况，那么就需要用try...catch代码块来包含调用的代码，否则也会出现语法错误。

6. 如果在try...catch部分使用了例如Connection对象，IO对象要在finally中关闭这些对象，否则对象所占用的内存资源无法被回收。或try...catch中用到了Arraylist,linkedlist,hashmap等，建议在finally中用clear进行清空，在finally中应尽可能的回收内存资源。


